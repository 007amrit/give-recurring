(()=>{"use strict";var e,t={312:(e,t,i)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=a(e);if(t){var r=a(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return c(this,i)}}function c(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}i.d(t,{Z:()=>u});var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(a,Give.modal.GiveModal);var t,i,n,c=s(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e.type="sync-subscription",(t=c.call(this,e)).init(),t}return t=a,(i=[{key:"getTemplate",value:function(){return jQuery("<div>").append(jQuery("#sync-subscription-modal").clone().removeClass("give-hidden")).html()}}])&&r(t.prototype,i),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}()}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e=n(312),jQuery(document).ready((function(t){var i={init:function(){this.edit_expiration(),this.edit_profile_id(),this.edit_transaction_id(),this.confirm_cancel(),this.confirm_delete(),this.confirm_sync(),this.toggle_renewal_form(),this.handle_status_change(),this.handle_bluk_action(),this.add_subscription_note(),this.remove_subscription_note(),this.handleSubscriptionStatusOptInField()},edit_subscription_input:function(e,t){e.text()===Give_Recurring_Vars.action_edit?(e.data("current-value",t.val()),e.text(Give_Recurring_Vars.action_cancel)):(t.val(e.data("current-value")),e.text(Give_Recurring_Vars.action_edit))},edit_expiration:function(){t(".give-edit-sub-expiration").on("click",(function(e){e.preventDefault();var n=t(this),r=t("input.give-sub-expiration");i.edit_subscription_input(n,r),t(".give-sub-expiration").toggle(),t("#give-sub-expiration-update-notice").slideToggle()}))},edit_profile_id:function(){t(".give-edit-sub-profile-id").on("click",(function(e){e.preventDefault();var n=t(this),r=t("input.give-sub-profile-id");i.edit_subscription_input(n,r),t(".give-sub-profile-id").toggle(),t("#give-sub-profile-id-update-notice").slideToggle()}))},edit_transaction_id:function(){t(".give-edit-sub-transaction-id").on("click",(function(e){e.preventDefault();var n=t(this),r=t("input.give-sub-transaction-id");i.edit_subscription_input(n,r),t(".give-sub-transaction-id").toggle()}))},confirm_cancel:function(){t(".give-subscription-admin-cancel").on("click",(function(){var e=t(this);return new Give.modal.GiveConfirmModal({modalContent:{desc:Give_Recurring_Vars.confirm_cancel},classes:{modalWrapper:"give-modal--error"},successConfirm:function(){window.location.assign(e.attr("href"))}}).render(),!1}))},confirm_delete:function(){t(".give-delete-subscription").on("click",(function(e){var i=t(this);return new Give.modal.GiveConfirmModal({modalContent:{desc:Give_Recurring_Vars.delete_subscription},classes:{modalWrapper:"give-modal--error"},successConfirm:function(){i.unbind().click()}}).render(),!1}))},confirm_sync:function(){var i=t("body");i.on("click","#give_sync_subscription",(function(){return new Give.modal.GiveConfirmModal({modalContent:{title:Give_Recurring_Vars.confirm_sync_modal_title,desc:Give_Recurring_Vars.confirm_sync},classes:{modalWrapper:"give-modal--notice"},successConfirm:function(){var n=t.Event("sync_subscription_clicked");n.subscription=t(this).data("subscription"),n.modal_id="#sync-subscription-modal";var r=window.setInterval((function(){jQuery.magnificPopup.instance.content||(new e.Z({}).render(),i.trigger(n),window.clearInterval(r))}),10)}}).render(),!1})),i.on("click",".give-resync-button",(function(){jQuery.magnificPopup.close();var e=window.setInterval((function(){jQuery.magnificPopup.instance.content||(window.clearInterval(e),t("#give_sync_subscription").trigger("click"))}),10)}))},toggle_renewal_form:function(){t(".give-add-renewal").on("click",(function(){t(".give-manual-add-renewal").toggle()})),t("#give-sub-add-renewal").on("submit",(function(e){t(this).find(".give-sub-renew-required-field").each((function(){t(this).val()||(t(this).addClass("renewal-invalid-field"),e.preventDefault())}))})),t(".give-sub-renew-required-field").on("focusout change",(function(){t(this).val()?t(this).removeClass("renewal-invalid-field"):t(this).addClass("renewal-invalid-field")}))},handle_status_change:function(){t("select#subscription_status").on("change",(function(){var e=t(this).val();t(".give-donation-status").removeClass((function(e,t){return(t.match(/\bstatus-\S+/g)||[]).join(" ")})).addClass("status-"+e)}))},handle_bluk_action:function(){t("body").on("click",'form#subscribers-filter .bulkactions input[type="submit"].action',(function(){var e=t(this).closest(".tablenav").find("select").val(),i=t(this).closest(".tablenav").find('option[value="'+e+'"]').text(),n=t('input[name="subscription[]"]:checked').length,r=-1!==e.indexOf("set-status-"),o="",s="";if(e=r?"set-to-status":e,Object.keys(Give_Recurring_Vars.subscriptions_bulk_action).length)for(s in Give_Recurring_Vars.subscriptions_bulk_action)if(s===e)return o=r?Give_Recurring_Vars.subscriptions_bulk_action[e].zero.replace("{status}",i.replace("Set To ","")):Give_Recurring_Vars.subscriptions_bulk_action[e].zero,parseInt(n)?(o=1<n?Give_Recurring_Vars.subscriptions_bulk_action[e].multiple:Give_Recurring_Vars.subscriptions_bulk_action[e].single,window.confirm(o.replace("{subscription_count}",n).replace("{status}",i.replace("Set To ","")))):(alert(o),!1);return!0}))},add_subscription_note:function(){t("#give-add-subscription-note").on("click",(function(e){var i=t(this);e.preventDefault(),i.attr("disabled","disabled");var n={action:"give_insert_subscription_note",subscription_id:t(this).data("subscription-id"),note:t("#give-subscription-note").val()};if(n.note)t.ajax({type:"POST",data:n,url:ajaxurl,success:function(e){i.removeAttr("disabled"),t("#give-subscription-notes-inner").append(e),t(".give-no-subscription-notes").hide(),t("#give-subscription-note").val("")}}).fail((function(e){window.console&&window.console.log&&console.log(e)}));else{i.removeAttr("disabled");var r=t("#give-subscription-note").css("border-color");t("#give-subscription-note").css("border-color","red"),setTimeout((function(){t("#give-subscription-note").css("border-color",r)}),500)}}))},remove_subscription_note:function(){t("body").on("click",".give-delete-subscription-note",(function(e){var i=t(this);e.preventDefault(),new Give.modal.GiveConfirmModal({modalContent:{title:Give.fn.getGlobalVar("confirm_deletion"),desc:Give_Recurring_Vars.delete_subscription_note},successConfirm:function(e){var n={action:"give_delete_subscription_note",subscription_id:i.attr("data-subscription-id"),note_id:i.attr("data-note-id"),security:Give_Recurring_Vars.adminAjaxNonce};t.ajax({type:"POST",data:n,url:ajaxurl,success:function(e){if(e.success)return t("#give-subscription-note-"+n.note_id).remove(),t(".give-subscription-note").length||t(".give-no-subscription-notes").show(),!1;t("#give-subscription-notes-error-wrap").html(e.data)}}).fail((function(e){console.log(e)}))}}).render()}))},handleSubscriptionStatusOptInField:function(){var e=document.getElementById("give-recurring-subscription-status-optin-wrap");if(e){var t=JSON.parse(e.getAttribute("data-optin-statues")),i=Object.keys(t);if(i&&i.length){var n=document.getElementById("subscription_status"),r=(e=n.parentElement.appendChild(e)).querySelector("label");n.addEventListener("change",(function(n){i.includes(n.target.value)?(r.innerText=t[n.target.value].checkboxLabel,e.classList.remove("give-hidden")):e.classList.add("give-hidden")}))}else e.remove()}}};i.init()}))})();